distribute-on:
  default: auto linux-large, 3 linux-extra-large
assignment-rules:
  - projects:
      - e2e-gradle
    targets:
      - e2e-ci**
    run-on:
      - agent: linux-extra-large
        parallelism: 1

  - projects:
      - nx
      - workspace
      - remix
      - nx-maven-plugin
    targets:
      - install
      - test
    run-on:
      - agent: linux-large
        parallelism: 1
      - agent: linux-extra-large
        parallelism: 1

  - targets:
      - e2e-ci**
    run-on:
      - agent: linux-large
        parallelism: 1
      - agent: linux-extra-large
        parallelism: 1

  # These projects should not need to be isolated.
  - projects:
      - nx-dev
    targets:
      - build*
    run-on:
      - agent: linux-extra-large
        parallelism: 1
  - projects:
      - angular
      - react
    targets:
      - test
    run-on:
      - agent: linux-extra-large
        parallelism: 1

  - targets:
      - lint
    run-on:
      - agent: linux-large
        parallelism: 6
      - agent: linux-extra-large
        parallelism: 6

  - targets:
      - "*"
    run-on:
      - agent: linux-large
        parallelism: 3
      - agent: linux-extra-large
        parallelism: 3
