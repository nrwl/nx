{
  "name": "release-version-config-changes",
  "version": "21.0.0-beta.1",
  "description": "Updates release version config based on the breaking changes in Nx v21",
  "implementation": "/packages/nx/src/migrations/update-21-0-0/release-version-config-changes.ts",
  "aliases": [],
  "hidden": false,
  "path": "/packages/nx",
  "schema": null,
  "type": "migration",
  "examplesFile": "#### Nx Release Version Config Changes\n\nIn Nx v21, the implementation details of versioning were rewritten to massively enhance flexibility and lay the groundwork for future features.\n\nAs part of this, some elements of the release configuration were updated. During the lifecycle of Nx v21, you can still opt into the old versioning by setting `release.version.useLegacyVersioning` to `true`, in which case the release configuration should remain unchanged.\n\nIn Nx v22, the legacy versioning implementation will be removed entirely and the configuration will have to be updated to match what this migration does for you.\n\n#### Sample Code Changes\n\n\"generatorOptions\" is longer exists and most non-ecosystem specific options have moved to the top level of \"version\" and are therefore fully documented on the JSON schema as a core option.\n\n\"packageRoot: string\" has been replaced by the more flexible concept of \"manifestRootsToUpdate: string[]\", allowing for multiple manifest files (such as `package.json` in the JS/TS ecosystem)\nto be updated in a single versioning run.\n\nEcosystem specific options, such as \"skipLockFileUpdate\", which is specific to the JS/TS ecosystem, are available via the new \"versionActionsOptions\" object, which is so named because of the new `VersionActions` abstraction introduced in Nx v21,\nwhich allows for different ecosystems and use-cases to be supported via very minimal implementation effort.\n\n\"preserveLocalDependencyProtocols\" changed from `false` by default to `true` by default in Nx v21, so it can simply be removed from the configuration when set to true.\n\nThe migration will also update release groups version configuration, as well as project.json and package.json version configuration, if applicable.\n\n{% tabs %}\n{% tab label=\"Before\" %}\n\n```json {% fileName=\"nx.json\" %}\n{\n  \"release\": {\n    \"version\": {\n      \"generatorOptions\": {\n        \"packageRoot\": \"build/packages/{projectName}\",\n        \"currentVersionResolver\": \"registry\",\n        \"skipLockFileUpdate\": true,\n        \"preserveLocalDependencyProtocols\": true\n      }\n    }\n  }\n}\n```\n\n{% /tab %}\n{% tab label=\"After\" %}\n\n```json {% fileName=\"nx.json\" %}\n{\n  \"release\": {\n    \"version\": {\n      \"manifestRootsToUpdate\": [\"build/packages/{projectName}\"],\n      \"currentVersionResolver\": \"registry\",\n      \"versionActionsOptions\": {\n        \"skipLockFileUpdate\": true\n      }\n    }\n  }\n}\n```\n\n{% /tab %}\n{% /tabs %}\n"
}
