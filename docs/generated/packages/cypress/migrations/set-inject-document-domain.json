{
  "name": "set-inject-document-domain",
  "cli": "nx",
  "version": "20.8.0-beta.0",
  "requires": { "cypress": ">=14.0.0" },
  "description": "Replaces the `experimentalSkipDomainInjection` configuration option with the new `injectDocumentDomain` configuration option.",
  "implementation": "/packages/cypress/src/migrations/update-20-8-0/set-inject-document-domain.ts",
  "aliases": [],
  "hidden": false,
  "path": "/packages/cypress",
  "schema": null,
  "type": "migration",
  "examplesFile": "#### Set `injectDocumentDomain` Configuration Option\n\nReplaces the removed `experimentalSkipDomainInjection` configuration option with the new `injectDocumentDomain` configuration option when needed. Skipping domain injection is the default behavior in Cypress v14 and therefore, it is required to use the `cy.origin()` command when navigating between domains. The `injectDocumentDomain` option was introduced to ease the transition to v14, but it is deprecated and will be removed in Cypress v15. Read more at the [migration notes](https://docs.cypress.io/app/references/migration-guide#Changes-to-cyorigin).\n\n#### Examples\n\nIf the `experimentalSkipDomainInjection` configuration option is present, the migration will remove it. This is to account for the fact that skipping domain injection is the default behavior in Cypress v14.\n\n{% tabs %}\n{% tab label=\"Before\" %}\n\n```ts {% fileName=\"apps/app1-e2e/cypress.config.ts\" %}\nimport { nxE2EPreset } from '@nx/cypress/plugins/cypress-preset';\nimport { defineConfig } from 'cypress';\n\nexport default defineConfig({\n  e2e: {\n    ...nxE2EPreset(__filename, {\n      cypressDir: 'src',\n      bundler: 'vite',\n      webServerCommands: {\n        default: 'pnpm exec nx run app1:dev',\n        production: 'pnpm exec nx run app1:dev',\n      },\n      ciWebServerCommand: 'pnpm exec nx run app1:dev',\n      ciBaseUrl: 'http://localhost:4200',\n    }),\n    baseUrl: 'http://localhost:4200',\n    experimentalSkipDomainInjection: ['https://example.com'],\n  },\n});\n```\n\n{% /tab %}\n\n{% tab label=\"After\" %}\n\n```ts {% fileName=\"apps/app1-e2e/cypress.config.ts\" %}\nimport { nxE2EPreset } from '@nx/cypress/plugins/cypress-preset';\nimport { defineConfig } from 'cypress';\n\nexport default defineConfig({\n  e2e: {\n    ...nxE2EPreset(__filename, {\n      cypressDir: 'src',\n      bundler: 'vite',\n      webServerCommands: {\n        default: 'pnpm exec nx run app1:dev',\n        production: 'pnpm exec nx run app1:dev',\n      },\n      ciWebServerCommand: 'pnpm exec nx run app1:dev',\n      ciBaseUrl: 'http://localhost:4200',\n    }),\n    baseUrl: 'http://localhost:4200',\n  },\n});\n```\n\n{% /tab %}\n\n{% /tabs %}\n\nIf the `experimentalSkipDomainInjection` configuration option is present and set to an empty array (no domain injection is skipped), the migration will remove it and will set the `injectDocumentDomain` option to `true`.\n\n{% tabs %}\n{% tab label=\"Before\" %}\n\n```ts {% fileName=\"apps/app1-e2e/cypress.config.ts\" %}\nimport { nxE2EPreset } from '@nx/cypress/plugins/cypress-preset';\nimport { defineConfig } from 'cypress';\n\nexport default defineConfig({\n  e2e: {\n    ...nxE2EPreset(__filename, {\n      cypressDir: 'src',\n      bundler: 'vite',\n      webServerCommands: {\n        default: 'pnpm exec nx run app1:dev',\n        production: 'pnpm exec nx run app1:dev',\n      },\n      ciWebServerCommand: 'pnpm exec nx run app1:dev',\n      ciBaseUrl: 'http://localhost:4200',\n    }),\n    baseUrl: 'http://localhost:4200',\n    experimentalSkipDomainInjection: [],\n  },\n});\n```\n\n{% /tab %}\n\n{% tab label=\"After\" %}\n\n```ts {% fileName=\"apps/app1-e2e/cypress.config.ts\" highlightLines=[\"17-19\"] %}\nimport { nxE2EPreset } from '@nx/cypress/plugins/cypress-preset';\nimport { defineConfig } from 'cypress';\n\nexport default defineConfig({\n  e2e: {\n    ...nxE2EPreset(__filename, {\n      cypressDir: 'src',\n      bundler: 'vite',\n      webServerCommands: {\n        default: 'pnpm exec nx run app1:dev',\n        production: 'pnpm exec nx run app1:dev',\n      },\n      ciWebServerCommand: 'pnpm exec nx run app1:dev',\n      ciBaseUrl: 'http://localhost:4200',\n    }),\n    baseUrl: 'http://localhost:4200',\n    // Please ensure you use `cy.origin()` when navigating between domains and remove this option.\n    // See https://docs.cypress.io/app/references/migration-guide#Changes-to-cyorigin\n    injectDocumentDomain: true,\n  },\n});\n```\n\n{% /tab %}\n\n{% /tabs %}\n\nIf the `experimentalSkipDomainInjection` configuration option is not present (no domain injection is skipped), the migration will set the `injectDocumentDomain` option to `true`.\n\n{% tabs %}\n{% tab label=\"Before\" %}\n\n```ts {% fileName=\"apps/app1-e2e/cypress.config.ts\" %}\nimport { nxE2EPreset } from '@nx/cypress/plugins/cypress-preset';\nimport { defineConfig } from 'cypress';\n\nexport default defineConfig({\n  e2e: {\n    ...nxE2EPreset(__filename, {\n      cypressDir: 'src',\n      bundler: 'vite',\n      webServerCommands: {\n        default: 'pnpm exec nx run app1:dev',\n        production: 'pnpm exec nx run app1:dev',\n      },\n      ciWebServerCommand: 'pnpm exec nx run app1:dev',\n      ciBaseUrl: 'http://localhost:4200',\n    }),\n    baseUrl: 'http://localhost:4200',\n  },\n});\n```\n\n{% /tab %}\n\n{% tab label=\"After\" %}\n\n```ts {% fileName=\"apps/app1-e2e/cypress.config.ts\" highlightLines=[\"17-19\"] %}\nimport { nxE2EPreset } from '@nx/cypress/plugins/cypress-preset';\nimport { defineConfig } from 'cypress';\n\nexport default defineConfig({\n  e2e: {\n    ...nxE2EPreset(__filename, {\n      cypressDir: 'src',\n      bundler: 'vite',\n      webServerCommands: {\n        default: 'pnpm exec nx run app1:dev',\n        production: 'pnpm exec nx run app1:dev',\n      },\n      ciWebServerCommand: 'pnpm exec nx run app1:dev',\n      ciBaseUrl: 'http://localhost:4200',\n    }),\n    baseUrl: 'http://localhost:4200',\n    // Please ensure you use `cy.origin()` when navigating between domains and remove this option.\n    // See https://docs.cypress.io/app/references/migration-guide#Changes-to-cyorigin\n    injectDocumentDomain: true,\n  },\n});\n```\n\n{% /tab %}\n\n{% /tabs %}\n"
}
